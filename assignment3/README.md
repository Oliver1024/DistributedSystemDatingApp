# CS6650 Spring 2023  Assignment 3

## Adding Persistence and Reads

This assignment builds on assignment 2. The main aim is to persist the swipes generated by your client and query them.

## Step 1 - Implement the GET methods in a servlet

Check out the API spec [here](https://app.swaggerhub.com/apis/IGORTON/Twinder/1.2.1), You need to implement the get methods in a servlet that your client can call.  Test them initally with POSTMAN and hardcoded results. We'll connect to a database soon. 

### Step 2 - Redesign your solution

The solution architecture should look something like this:

1. Client as per assignment 1 to generate Swipe events ans send to server. You will also add GET requests. Details below.

2. A Servlet implements doPost and writes every Swipe event to a persistent store we'll call *TempStore*. This could be a persistent queue or a database table. Your choice. It must be safe - ie persistent.

3. A consumer reads new Swipe events from *TempStore* and updates a database that stores information about users and swipe events. We'll call this *SwipeData*. 

4. A servlet implements the GET requests and retrieves results from the *SwipeData* database directly. Note the /matches API only returns *potential* matches. You do not have to calculate actual matches.

In the design, think about how you can get high throughput and low response times, and also keep you architecture and deployment as simple and low cost as possible. It's a balancing act.

## Step 3 - Implement your solution

You will need to run:

1. your client on laptop (or EC2 instance if you like?)

2. a servlet for doPost and doGet. One servlet? 2 servlets? 

3. a queue broker or DB server for *TempStore*

4. a Plain old Java Program consumer that reads from *TempStore  and writes to  SwipeData*

5. a DB server for *SwipeData* (potentially same beast as (3) above)

In this assignment you are free to choose your own database. Popular past choices are:

* MySQL using AWS RDS, Postgres or Aurora
* DynamoDB
* MongoDB

You can find a summary of AWS databases and costs [here](https://aws.amazon.com/free/database/). Choose wisely!

The data model you design in the database should enable the queries for the GET requests to be highly efficient. 

#### Step 4 - Modify the Client

You need to add a single thread to your client - let's call it GetThread. GetThread:

1. is started after all the posting threads have started

2. generates 5 GET requests with randomly generated data every second and records the latencies. There are two APIs, so just mix up which ones you call each time.

3. terminates immediately after the last posting thread terminates. Before termination it prints out the min, mean and max latencies for the GETs it sent.

### Step 5 - Putting it all Together

This is the fun bit. Run tests that populate the database as fast as possible. 

Your aim is to try and deliver throughput and latencies at the client within 10% of Assignment 2 (or even better, faster!) . In addition, your GET request mean latency should be no longer than the mean POST request latency.

Simple, eh? :)

## Submission Requirements

Submit your work to Canvas Assignment 3 as a pdf document. The document should contain:

1. The URL for your git repo. Create a new folder for your Assignment 3 server and client code
2. A short description of your solution architecture (diagram please), database designs and deployment topologies on AWS. Include instance types if you have increased capacity.
3. Client test run screen shots showing your results for GET and POST requests. Show an explicit comparison with Assignment 2 results.

## Grading:

1. Servers and database implementations working (15 points)
2. Solution architecture and database design description (10 points)
3. Client screenshots showing your best performance and comparisons with Assignment 2 for POST requests. (15 points)

# Deadline: 4/2 11.59pm PST

##### Addendum - DynamoDB

**For those interested inDynamoDB**

If you are interested in using DynamoDB, here are some hopefully useful resources:

1. A series of documentation explaining how to set up confidential before you could make requests to AWS using AWS SDK for Java 2.X.  
   https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/credentials.html.  
   I have already verified the first two options work well in this [section](https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdocs.aws.amazon.com%2Fsdk-for-java%2Flatest%2Fdeveloper-guide%2Fcredentials-chain.html&data=05%7C01%7Ci.gorton%40northeastern.edu%7Cefdb3826568247aa065008db28ec6227%7Ca8eec281aaa34daeac9b9a398b9215e7%7C0%7C0%7C638148767954694150%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=Ul2Fq9eVxt0UogRJ26m%2BbbnrLU8sN9r6LruwHR%2Flny0%3D&reserved=0).  
   The credentials(aws_access_key_id, aws_secret_access_key, aws_session_token) could be found on your learner's lab page by clicking the right top corner "aws details"
2. Examples of interacting with DynamoDB using AWS SDK for Java 2.X.  
   https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStarted.html  
   I also found the API reference included in each example really helpful.

DynamoDBPricing  
https://aws.amazon.com/dynamodb/pricing/  
Pay attention to the difference between “provisioned capacity mode” and“on-demand capacity mode”.  
As to how to set billing mode in code, check link below https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/services/dynamodb/model/CreateTableRequest.html#billingMode()Version:1.0StartHTML:0000000105EndHTML:0000042057StartFragment:0000039335EndFragment:0000042017<style></style>
